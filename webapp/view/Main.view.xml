<mvc:View controllerName="zgvt.commodity.upload.commodityupload.controller.Main"
    displayBlock     ="true"
    xmlns            ="sap.m"
    xmlns:mvc        ="sap.ui.core.mvc" 
    xmlns:u          ="sap.ui.unified" 
    xmlns:core       ="sap.ui.core"
    xmlns:l          ="sap.ui.layout"
    xmlns:upload     ="sap.m.upload"
    xmlns:t          ="sap.ui.table"
    xmlns:sap.ui.fl  ="sap.ui.fl"
    xmlns:sap.ui.dt  ="sap.ui.dt"
    xmlns:vm         ="sap.ui.fl.variants"
    xmlns:html       ="http://www.w3.org/1999/xhtml"
	xmlns:app        ="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
    <Page id="page" title="{i18n>title}">
      <content>
    	
        <l:VerticalLayout id ='vlmain'
	                	  class="sapUiResponsiveContentPadding"
                		  width="100%" >
                <Label id = 'lblMainSelectSchema' text="Select Schema" class= "sapUiTinyMarginTop"></Label>
                   	<ComboBox id ='cbValue'
                            items="{
                                path: 'oSchemaList>/Schema'
                           }"
                        width = "35%"
						 change = "handleChange">
        				<core:Item key="{oSchemaList>Nosct}" text="{oSchemaList>Text}" />
						
			        </ComboBox>
	    </l:VerticalLayout>
         		<upload:UploadSet
				id="UploadSet"
				instantUpload="true"
				showIcons="true"
				uploadEnabled="false"
				terminationEnabled="true"
				fileTypes="xlsx"
				maxFileNameLength="50"
				maxFileSize="200"
                mediaTypes="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
				items="{path: 'oTemplateList>/file', templateShareable: false}"
               
				selectionChanged="onSelectionChange" 
            
                visible="{model2>/status}">

			<upload:toolbar >
				<OverflowToolbar>
					<ToolbarSpacer/>
					<Button
							id     ="downloadSelectedButton"
							text   ="Download Template"
							press  ="onDownloadSelectedButton"
                            visible="false"/>
				</OverflowToolbar>
			</upload:toolbar>
			<upload:items>
				<upload:UploadSetItem
						fileName     ="{oTemplateList>Filename}"
						mediaType    ="{oTemplateList>Content}"
                      
                        visibleRemove ="false"
                        visibleEdit    ="false"
						url          ="/sap/opu/odata/sap/ZVGT_UPLD_COMMCODES_SRV/ET_TemplateSet('{oTemplateList>Nosct}')/$value"
						
                        uploadState  ="{uploadState}">
				</upload:UploadSetItem>
			</upload:items>
            
		</upload:UploadSet> 

	<l:VerticalLayout class= "sapUiSmallMarginBegin">
		<u:FileUploader
			id="fileUploader"
			name="myFileUpload"
            fileType="XLSX,CSV"
            width = "50%"
			tooltip="Upload your file to the local server"
			uploadComplete="handleUploadComplete"
            visible="{model2>/status}"/>
            
		<Button
			text="Upload Excel File"
			press="handleUploadPress"
            visible="{model2>/status}"/>
	</l:VerticalLayout>
        <t:Table id="persoTable" 
         selectionMode="None"
         rows="{oReturnMessage>/items}"
         visible="{model2>/status}">
       
         <t:extension>
                <OverflowToolbar >
                    <Title id="title" text="Return Logs"/>
                    <ToolbarSeparator/>
                     <ToolbarSpacer/>
                    <Button icon="sap-icon://action-settings" press="openPersoDialog" tooltip="Settings"/>
                </OverflowToolbar>
          </t:extension>
                <t:columns>
                  <t:Column app:p13nKey="Schema_col" sortProperty="Schema" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Schema Code" />
                    <t:template>
                        <Text text="{oReturnMessage>Schema}"/>
                    </t:template>
                 </t:Column>
                 <t:Column app:p13nKey="Comco_col" sortProperty="Comco" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Commodity Code" />
                    <t:template>
                        <Text text="{oReturnMessage>Comco}"/>
                    </t:template>
                 </t:Column>
                 <t:Column app:p13nKey="Text_col" sortProperty="Text" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Description" />
                    <t:template>
                        <Text text="{oReturnMessage>Text}"/>
                    </t:template>
                 </t:Column>
                 <t:Column app:p13nKey="DATAB_col" sortProperty="DATAB" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Valid from" />
                    <t:template>
                        <Text text="{oReturnMessage>DATAB}"/>
                    </t:template>
                 </t:Column>
                   <t:Column app:p13nKey="DATBI_col" sortProperty="DATBI" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Valid To" />
                    <t:template>
                        <Text text="{oReturnMessage>DATBI}"/>
                    </t:template>
                 </t:Column>
                  <t:Column app:p13nKey="BEMEH_col" sortProperty="BEMEH" resizable="true" width="11rem" autoResizable="true">
                    <Label text="First Unit" />
                    <t:template>
                        <Text text="{oReturnMessage>BEMEH}"/>
                    </t:template>
                 </t:Column>
                    <t:Column app:p13nKey="Status_col" sortProperty="Status" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Status" />
                    <t:template>
                        <Text text="{oReturnMessage>Status}"/>
                    </t:template>
                 </t:Column>
             
                   <t:Column app:p13nKey="Message_col" sortProperty="Message" resizable="true" width="11rem" autoResizable="true">
                    <Label text="Messahe" />
                    <t:template>
                        <Text text="{oReturnMessage>Message}"/>
                    </t:template>
                 </t:Column>
                </t:columns>
            </t:Table> 
    
        </content>
      </Page>
</mvc:View>